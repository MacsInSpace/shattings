#!/bin/sh

CALLSIGN=${1-$(xargs)}
HAMADDR=$(callsign-to-ham-addr $CALLSIGN | sed 's/[^a-fA-F0-9]//g')
#HAMADDR="0123456789AB"
#HAMADDR="AAAABBBBCCCCDDDD"

while [ ${#HAMADDR} -lt 16 ] ; do HAMADDR="${HAMADDR}0" ; done

if [ ${#CALLSIGN} -lt 9 ]
then
	first_byte=0x${HAMADDR:10:2}
	MACADDR=`printf %02X%s $(((first_byte & 0xF8) + 0x02)) ${HAMADDR:0:10}`
	MACADDR=${MACADDR:0:6}FFFE${MACADDR:6:12}
else
	first_byte=0x${HAMADDR:14:2}
	MACADDR=`printf %02X%s $(((first_byte & 0xF8) + 0x02)) ${HAMADDR:0:14}`
fi

#echo ${HAMADDR} > /dev/stderr

echo ${MACADDR}

exit 0

